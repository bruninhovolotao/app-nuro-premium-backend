generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id        Int      @id @default(autoincrement())
  name      String   @db.VarChar(50)
  email     String   @db.VarChar(255)
  password  String   @db.VarChar(255)
  username  String   @db.VarChar(50)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  authToken String?
  tipo      Tipo     @default(USER)

  @@map("user")
}

model Client {
  id                   Int                    @id @default(autoincrement())
  name                 String                 @db.VarChar(50)
  createdAt            DateTime               @default(now())
  updatedAt            DateTime               @updatedAt
  FinancialTransaction FinancialTransaction[]

  @@map("client")
}

model Professional {
  id                Int           @id @default(autoincrement())
  name              String        @db.VarChar(50)
  serviceCommission Decimal       @default(0.00) @db.Decimal(5, 2)
  productCommission Decimal       @default(0.00) @db.Decimal(5, 2)
  createdAt         DateTime      @default(now())
  updatedAt         DateTime      @updatedAt
  productItems      ProductItem[]
  serviceItems      ServiceItem[]

  @@map("professional")
}

model FinancialTransaction {
  id            Int           @id @default(autoincrement())
  date          DateTime      @default(now())
  totalAmount   Decimal       @default(0.00) @db.Decimal(10, 2)
  paymentMethod String        @db.VarChar(50)
  notes         String?       @db.VarChar(255)
  clientId      Int
  createdAt     DateTime      @default(now())
  updatedAt     DateTime      @updatedAt
  unidade       String?       @db.VarChar(255)
  createdbyuser String?       @db.VarChar(255)
  productItems  ProductItem[]
  serviceItems  ServiceItem[]
  client        Client        @relation(fields: [clientId], references: [id])

  @@map("financial_transaction")
}

model ServiceItem {
  id                     Int                  @id @default(autoincrement())
  name                   String
  price                  Decimal              @db.Decimal(10, 2)
  quantity               Int                  @default(1)
  professionalId         Int
  financialTransactionId Int
  financialTransaction   FinancialTransaction @relation(fields: [financialTransactionId], references: [id])
  professional           Professional         @relation(fields: [professionalId], references: [id])
}

model ProductItem {
  id                     Int                  @id @default(autoincrement())
  name                   String
  price                  Decimal              @db.Decimal(10, 2)
  quantity               Int                  @default(1)
  professionalId         Int
  financialTransactionId Int
  financialTransaction   FinancialTransaction @relation(fields: [financialTransactionId], references: [id])
  professional           Professional         @relation(fields: [professionalId], references: [id])
}

enum Tipo {
  USER
  ADMIN
}
